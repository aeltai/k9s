# Harvester UI plugin for rk9s
# VM lifecycle commands (console, vnc, start, stop, etc.) are in virtctl.yaml
plugins:
  harvester-open-ui:
    shortCut: Shift-H
    description: Open Harvester UI in browser
    scopes:
      - virtualmachines.kubevirt.io
      - virtualmachineinstances.kubevirt.io
      - all
    command: bash
    background: true
    args:
      - -c
      - |
        server=$(kubectl config view --context $CONTEXT --minify -o jsonpath='{.clusters[0].cluster.server}' 2>/dev/null | sed 's|https://||' | sed 's|:6443||' | cut -d/ -f1)
        if [ -n "$server" ]; then
          open "https://${server}" 2>/dev/null || xdg-open "https://${server}" 2>/dev/null || echo "Harvester UI: https://${server}"
        else
          echo "Could not determine Harvester server URL."
        fi
